<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Calendario de Tareas</title>

<style>
body {
  font-family: Arial, sans-serif;
  max-width: 800px;
  margin: auto;
}
h1 {
  text-align: center;
}
.calendar {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 5px;
}
.day {
  border: 1px solid #ccc;
  padding: 10px;
  min-height: 80px;
  cursor: pointer;
}
.day:hover {
  background: #f0f0f0;
}
.selected {
  background: #d0e7ff;
}
.task {
  display: flex;
  align-items: center;
}
.task span.completed {
  text-decoration: line-through;
  color: gray;
}
</style>
</head>

<body>

<h1>Calendario de Tareas</h1>

<div class="calendar" id="calendar"></div>

<h3 id="selectedDateTitle">Selecciona un d√≠a</h3>

<input id="taskInput" placeholder="Nueva tarea">
<button onclick="addTask()">Agregar tarea</button>

<ul id="taskList"></ul>

<script>
const calendar = document.getElementById("calendar");
const taskList = document.getElementById("taskList");
const selectedDateTitle = document.getElementById("selectedDateTitle");

let selectedDate = null;
let tasks = JSON.parse(localStorage.getItem("calendarTasks")) || {};

const today = new Date();
const year = today.getFullYear();
const month = today.getMonth();

function renderCalendar() {
  calendar.innerHTML = "";
  const firstDay = new Date(year, month, 1).getDay();
  const daysInMonth = new Date(year, month + 1, 0).getDate();

  for (let i = 0; i < firstDay; i++) {
    calendar.innerHTML += `<div></div>`;
  }

  for (let day = 1; day <= daysInMonth; day++) {
    const dateKey = `${year}-${month + 1}-${day}`;
    const div = document.createElement("div");
    div.className = "day";
    div.innerHTML = `<strong>${day}</strong>`;
    if (tasks[dateKey]) {
      div.innerHTML += `<br>üìå ${tasks[dateKey].length}`;
    }
    div.onclick = () => selectDate(dateKey, div);
    calendar.appendChild(div);
  }
}

function selectDate(dateKey, element) {
  document.querySelectorAll(".day").forEach(d => d.classList.remove("selected"));
  element.classList.add("selected");

  selectedDate = dateKey;
  selectedDateTitle.innerText = `Tareas para ${dateKey}`;
  renderTasks();
}

function addTask() {
  if (!selectedDate || !taskInput.value) return;

  if (!tasks[selectedDate]) tasks[selectedDate] = [];

  tasks[selectedDate].push({
    text: taskInput.value,
    done: false
  });

  taskInput.value = "";
  saveTasks();
  renderTasks();
  renderCalendar();
}

function renderTasks() {
  taskList.innerHTML = "";
  const dayTasks = tasks[selectedDate] || [];

  dayTasks.forEach((task, index) => {
    const li = document.createElement("li");
    li.className = "task";
    li.innerHTML = `
      <input type="checkbox" ${task.done ? "checked" : ""}
        onchange="toggleTask(${index})">
      <span class="${task.done ? "completed" : ""}">
        ${task.text}
      </span>
    `;
    taskList.appendChild(li);
  });
}

function toggleTask(index) {
  tasks[selectedDate][index].done = !tasks[selectedDate][index].done;
  saveTasks();
  renderTasks();
}

function saveTasks() {
  localStorage.setItem("calendarTasks", JSON.stringify(tasks));
}

renderCalendar();
</script>

</body>
</html>
